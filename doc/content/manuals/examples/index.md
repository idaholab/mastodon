#MASTODON Finite Element Analysis Framework for Seismic Applications

## Example 1

This example is designated to conduct single element direct simple shear test that utilizes I-soil with auto generated backbone curve using \citet{darendeli2001development} modulus reduction curves. The relevant files for the example are:

!listing examples/ex01/HYS_darendeli.i

In above input file, all the command blocks except material definition are explained at [Getting Started](manuals/user/index.md) section of User's Manual.

For this particular example, the units defining the parameters are kN, ton, and meter (m), and the material definition is created using following command:

!listing examples/ex01/HYS_darendeli.i start=Materials end=Preconditioning

where;

`soil type = 1` ; specifies that the backbone will be auto-generated by MASTODON using \citet{darendeli2001development} correlations.

`over_consolidation_ratio = '1'`; specifies that the over consolidation ratio for the soil material is 1 and it is normally consolidated. (see \citet{tpmsoilmechanics} for further information)

`plasticity_index = '0'`; specifies that the plasticity index of the soil is 0. The plasticity index is the difference between liquid limit and plastic limit (PI = LL - PL). PI = 0 means the soil is nonplastic, i.e., there is very little or no fines.

`initial_shear_modulus = '20000'`;  specifies the small strain shear modulus (elastic property) of the soil.

`initial_bul_modulus = '43333.33'`; specifies the small strain bulk modulus (elastic property) of the soil.

`number_of_points = '10'`;  specifies that there will be total number of 10 nested components that are superposed to obtain backbone curve.

`poissons_ratio = '0.3'`; specifies the Poisson's ratio (elastic property) for the soil.

`block = 0`; specifies that the material block will be assigned to element with block id = 0;

`initial_stress = '-4.204286 0 0  0 -4.204286 0  0 0 -9.810'`; see [Getting Started](manuals/user/index.md)

`density = '2'` specifies the density of the soil material;

`p_ref = '6.07286'` is the reference pressure at which the backbone curve is defined.

The material used in this example is pressure independent thus no further input is required. The BCs block given below shows that a shear displacement is applied at the upper surface in x direction and the bottom surface of the element is fixed. This leads to a 0.02 cyclic shear strain amplitude.

!listing examples/ex01/HYS_darendeli.i start=BCs end=Functions

where Displacement2.csv is the .csv file containing the displacement time history.

This analysis will produce the hysteretic response plotted in \ref{fig:example1stressstrain}

!media media/examples/example1stressstrain.png width=60% margin-left=150px float=center id=fig:example1stressstrain caption=Hysteretic response under 0.02 cyclic strian amplitude.

## Example 2

This example  is designated to conduct single element direct simple shear test that utilizes I-soil with GQ/H backbone generation method \citep{groholski2016simplified}. For this particular example, the units defining the parameters are N, kg, and meter (m), and the material definition is created using following command:

!listing examples/ex02/HYS_GQH.i start=Materials end=Preconditioning

where

`theta_1 through theta_2` ; are curve fitting parameters obtained from DEEPSOIL \citep{hashash2016deepsoil}.

`taumax = 7500` ; specifies maximum shear strength achieved at large shear strains.

Other parameters are the same as in [Example 1](manuals/examples/index.md). Once the same boundary conditions are applied as in [Example 1](manuals/examples/index.md),  the following response is obtained

!media media/examples/example2stressstrain.png width=60% margin-left=150px float=center id=fig:example2stressstrain caption=Hysteretic response under 0.02 cyclic strian amplitude.

!!! info
    Observe that in Example 2, the shear stress mobilized at shear strain of 0.02 is 6 kPa whereas in Example 1, the mobilized shear stress is ~ 4 kPa. This is because in Example 1, the backbone asymptotically approaches to 4 kPa which is implied by \citet{darendeli2001development} at large strains whereas in Example 2, the shear stress asymptotically approaches to 7.5 kPa at large strains (0.1)


## Example 3

This example is designated to conduct nonlinear site response analysis using I-soil. A 20 m soil column is created and meshed to have 20 elements each having 1 m x 1 m x 1 m dimensions. Shear wave velocity (so that the small strain shear modulus) is depth dependent and has a value of 100 m/sec at top and 250 m/sec at bottom. \ref{fig:1dsoilcolumn} demonstrates the geometry of the problem.

!media media/examples/1dsoilcolumn.png width=60% margin-left=150px float=center id=fig:1dsoilcolumn caption=Schematic of the non-uniform shear beam model (reprinted from Baltaji et al. 2017).

Below is the full input file provided to run this analysis.

!listing examples/ex03/shear_beam_Isoil_free_field.i

First step is to create the problem geometry. For simpler geometries, MASTODON provides automeshing option and has the following block to generate the mesh described in \ref{fig:1dsoilcolumn} :

!listing examples/ex03/shear_beam_Isoil_free_field.i start=Mesh end=GlobalParams

Following the Mesh block, GlobalParams, Variables, AuxVariables, Kernels, and AuxKernels are defined and detailed information about these blocks can be found at [Getting Started](manuals/user/index.md).

The shear beam model is fixed at gravity direction (z), the nodes at the same elevation are constrained to move equally via periodic boundary condition and acceleration time history is applied at the bottom of the column in x direction using following commands:

!listing examples/ex03/shear_beam_Isoil_free_field.i start=BCs end=Functions

In above block of commands, PresetAcceleration type boundary condition is used to define the bease excitation. Function of "function=accel_bottom" is used to input the acceleration time history and this function is defined as:

!listing examples/ex03/shear_beam_Isoil_free_field.i start=Functions end=Materials

The function block also includes the gravity (9.81 m/s$^2$), depth and density (2000 ton/m$^3$) dependent functions for initial stress to create in-situ soil conditions. Lateral stresses are defined using K0 conditions (lateral earth pressure coefficient at rest) and for this example it is calculated as K0 = Poisson's Ratio / (1-Poisson's ratio) where Poisson's ratio is chosen to be 0.3. Once the base excitation and initial stresses are defined, the material definition block is used to create the soil properties for each layer as:

!listing examples/ex03/shear_beam_Isoil_free_field.i start=Materials end=Preconditioning

The above command uses strength controlled backbone curve (using GQ/H model) with 100 shear stress - shear strain points along with small strain (i.e., initial) shear modulus $G_0$ that are compatible with shear wave velocity $(V_s)$ profile presented in \ref{fig:1dsoilcolumn}. The initial shear modulus - shear wave velocity compatibility is ensured by calculating $G_0$ as $\rho$ * $(V_s)^2$. The initial bulk modulus ($B_0$) is calculated using elastic relationship between $B_0$ and $G_0$ via Poisson's ratio.
The reference pressure $ p_{ref} $ is calculated at each layer and corresponds to mean effective confining pressure at which the dynamic soil properties are defined.

!media media/examples/MRBB.png width=60% margin-left=150px float=center id=fig:MRBB caption=Modulus reduction and backbone curves (reprinted from Baltaji et al. 2017).

For this example, since the model does not exhibit significant effective mean stress change throughout the shaking, the pressure dependency parameters set to be $ a_0 $ = 1, $ a_1 $ = 0, $ a_2 $ = 0, and $b$ = 0 so that the model is pressure independent.

Finally, the execution and output commands are provided to run the analysis and extract the data using following chain of blocks (see [Getting Started](manuals/user/index.md)):

!listing examples/ex03/shear_beam_Isoil_free_field.i start=Preconditioning

Accelerations obtained at the bottom, mid-depth and top of the soil columns are used to calculate the spectral response for 5 percent damping, the results are compared to analogous model developed in DEEPSOIL and presented in  

!media media/examples/shearbeam.png width=60% margin-left=150px float=center id=fig:shearbeam caption=Comparison of spectral accelerations from MASTODON and DEEPSOIL (modified from Baltaji et al. 2017).

Further details regarding to application of MASTODON to simulate seismic site response and soil structure interaction analysis can be found in \citet{baltaji2017nonlinear}.

## Example 4

This example describes a methodology on how to model frictional contact using the existing tools in MASTODON. Two brick elements are stacked vertically and a thin layer is modeled to describe the frictional contact (see \ref{fig:undeformedcontact}). Top and bottom layers use linear elastic material model whereas thin layer uses I-soil to approximate a contact behavior with elastic - nearly perfectly plastic shear behavior.

!listing examples/ex04/2BlockFriction_Isoilunit.i

!media media/examples/undeformedcontact.png width=80% margin-left=200px float=center id=fig:undeformedcontact caption=Undeformed shape of the numerical model.

The domain is loaded with gravity and top element is sheared on the top surface. At intermediate steps whereby the contact strength is yet not mobilized, no separation occurs between two elastic blocks as it is shown in \ref{fig:intermediate}.

!media media/examples/intermediate.png width=30% margin-left=200px float=center id=fig:intermediate caption=Intermediate step whereby the contact layer strength is not mobilized.

Once the contact layer is yielded, the upper block starts to slide on top of the lower block and thin layer effectively simulates the interface between two elastic layers (see \ref{fig:deformed}).

!media media/examples/deformed.png width=30% margin-left=200px float=center id=fig:deformed caption=Deformed shape of the numerical model after the contact is yielded.










\bibliographystyle{unsrt}
\bibliography{doc/bib/mastodon.bib}
